CREATE TABLE SALESMAN
 (
 SALESMAN_ID INT PRIMARY KEY,
 NAME VARCHAR (20),
 CITY VARCHAR (20),
 COMMISSION VARCHAR (20)
);

CREATE TABLE CUSTOMER
 (
CUSTOMER_ID INT PRIMARY KEY, 
CUST_NAME VARCHAR (20),
CITY VARCHAR (20),
 GRADE INT,
SALESMAN_ID INT REFERENCES SALESMAN (SALESMAN_ID) ON DELETE SET NULL);


CREATE TABLE ORDERS
(
ORD_NO           INT PRIMARY KEY,
PURCHASE_AMT     DECIMAL (10, 2),
ORD_DATE         DATE,
CUSTOMER_ID      INT,
SALESMAN_ID      INT,
FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID) ON DELETE CASCADE, 
FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN (SALESMAN_ID) ON DELETE CASCADE
);

INSERT INTO SALESMAN VALUES(101,'rabay', 'shiralkoppa','18%');

INSERT INTO CUSTOMER VALUES(501, 'sharbanu', 'LOS ANGELES', 10,103);

INSERT INTO ORDERS VALUES(1,1000,'04-feb-2022',501,103);

i) SELECT GRADE, COUNT(CUSTOMER_ID) FROM CUSTOMER GROUP BY GRADE HAVING GRADE >(SELECT AVG (GRADE) FROM CUSTOMER WHERE CITY='bhatkal');

ii)  salesman_id,name from salesman a where 1<(select count (*)from customer where salesman_id=a.salesman_id);

iii) select s.salesman_id,name,cust_name,commission from salesman s,customer c where s.city=c.city UNION select salesman_id,name,'no_match',commission from salesman where city=any(select city from customer) order by 2 desc;
 
iv) CREATE VIEW VW_ELITSALESMAN AS SELECT B.0RD_DATE,A.SALESMAN_ID,A.NAME FROM SALESMAN A ,ORDERS B WHERE A.SALESMAN_ID=B.SALESMAN_ID AND B.PURCHASE_AMT=(SELECT MAX(PURCHASE_AMT) FROM ORDERS C WHERE C.ORD_DATE=B.ORD_DATE);

v)DELETE FROM SALESMAN WHERE SALESMAN_ID=101;
 