LAB PROGRAM DBMS 5

maintain dealer book

AUTHOR (AID:STRING, ANAME: STRING, ACITY:STRING, ACOUNTRY:STRING)

PUBLISHER (PID:STRING, PNAME:STRING, PCITY:STRING, PCOUNTRY:STRING)

CATEGORY (CID:STRING, DESCRIPTION: STRING)

CATALOGG (BID:STRING, BTITLE: STRING, AID:STRING, PID:STRING, CID:STRING, BYEAR:INT, BPRICE:INT)

ORDERS (ONO STRING, BID:STRING, BQTY:INT)

QUESTIONS

A) create the above tables by properly specifying the primary keys and the foreign keys.

B) enter at least five tuples for each relation.

C) view the tables.

D) give the details of the authors who have two or more books in the catalog and the price of their total books are greater than the average price of the books in the catalog & the year of publication is after 2000.

E) find the author of the book which has maximun sales

F) Demonstrate how you increase the price of book published by a specific publisher by 10%.

ANSWERS
A) CREATE TABLES CORRECTLY

SQL> CREATE TABLE AUTHOR (
 AID VARCHAR2(20) PRIMARY KEY,
 ANAME VARCHAR2(20),
 ACITY VARCHAR2(20),
 ACOUNTRY VARCHAR2(20));

Table created.

SQL> CREATE TABLE PUBLISHER(
 PID VARCHAR2(20) PRIMARY KEY,
 PNAME VARCHAR2(20),
 PCITY VARCHAR2(20),
 PCOUNTRY VARCHAR2(20));

Table created.

SQL> CREATE TABLE CATEGORY(
 CID VARCHAR2(20) PRIMARY KEY,
 DESCRIPTION VARCHAR2(20));

Table created.

SQL CREATE TABLE CATALOGG(
 BID VARCHAR2(20) PRIMARY KEY,
 BTITLE VARCHAR2(20),
 AID VARCHAR2(20) REFERENCES AUTHOR,
 PID VARCHAR2(20) REFERENCES PUBLISHER, 
 CID VARCHAR2(20) REFERENCES CATEGORY,
 BYEAR NUMBER(10),
 BPRICE NUMBER(10));

Table created.

SOL> CREATE TABLE ORDERS(
 ONO VARCHAR2(20) PRIMARY KEY,
 BID VARCHAR2(20) REFERENCES CATALOGG,
  BQTY NUMBER(10));
B) INSERT THE DATA

SQL> INSERT INTO AUTHOR VALUES('&AID', '&ANAME', '&ACITY', '&ACOUNTRY');

SQL>  INSERT INTO PUBLISHER VALUES('&PID', '&PNAME', '&PCITY', '&PCOUNTRY');

SQL> INSERT INTO CATEGORY VALUES('&CID', '&DESCRIPTION');

SQL>  INSERT INTO CATALOGG VALUES('&BID', '&BTITLE', '&AID', '&PID', '&CID', '&BYEAR', '&BPRICE');

SQL>  INSERT INTO ORDERS VALUES('&ONO', '&BID', '&BQTY');

C) VIEW THE DATA

SQL> SELECT * FROM AUTHOR;
SQL> SELECT * FROM PUBLISHER;
SQL> SELECT * FROM CATEGORY;
SQL> SELECT * FROM CATALOGG;
SQL> SELECT * FROM ORDERS;

D) GIVE THE DETAILS OF THE AUTHORS WHO HAVE TWO OR MORE BOOKS IN THE CATALOG AND THE PRICE OF THEIR TOTAL BOOKS ARE GREATER THAN THE AVERAGE PRICE OF THE BOOKS IN THE CATALOG & THE YEAR OF PUBLICATION IS AFTER 2000.

SOL> SELECT *FROM AUTHOR
 WHERE
 AUTHOR.AID IN
 (SELECT CATALOGG.AID FROM CATALOGG WHERE CATALOGG.BYEAR>=2015 
 AND 
CATALOGG.BPRICE>(SELECT AVG(BPRICE) FROM CATALOGG)
 GROUP BY 
CATALOGG.AID
 HAVING COUNT(AID)>=2);

E) FIND THE AUTHOR OF THE BOOK WHICH HAS MAXIMUN SALES

SQL> select aid from catalogg,orders where orders.bid=catalogg.bid and bqty=(select max(bqty) from orders);

F) DEMONSTRATE HOW YOU INCREASE THE PRICE OF BOOK PUBLISHED BY A SPECIFIC PUBLISHER BY 10%.

SQL> update catalogg set bprice=bprice+(bprice*0.10) where pid in(select publisher.pid from publisher where publisher.pname='publisher-1');
