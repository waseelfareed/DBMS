LAB PROGRAM DBMS 4

 Consider the Insurance database given below. The primary keys are underlined and the data types are specified.

PERSON (DID: STRING, DNAME: STRING, DADDRESS: STRING)

CAR (CREGNO: STRING, CMODEL: STRING, CYEAR: INT)

ACCIDENT (REPNO: INT, REPDATE: DATE, LOCATION: STRING)

OWNS (DID: STRING. CREGNO: STRING)

PARTICIPATED (DID: STRING, CREGNO: STRING, REPNO:INT, DAMAGEAMT: INT)

QUESTIONS

(A) Create the above tables by properly specifying the primary keys and the foreign keys.

(B) Enter at least five tuples for each relation.

(C) View the Tables

(D) Demonstrate how you

a. Update the damage amount for the car with a specific Regno in the accident with report number 1 to 3.

b. Add a new accident to the Accident Table.

(D) Find the total number of people who owned cars that were involved in accidents in 2018

(F) Find the number of accidents in which cars belonging to a specific model were involved.

ANSWERS

A) Create the above tables by properly specifying the primary keys and the foreign keys.

 CREATE TABLE PERSON(DID VARCHAR2(20) PRIMARY KEY,DNAME VARCHAR2(20),DADDRESS VARCHAR2(20));

 CREATE TABLE CAR (CREGNO VARCHAR2(20) PRIMARY KEY,CMODEL VARCHAR2(20),CYEAR NUMBER(10));

 CREATE TABLE ACCIDENT(REPNO NUMBER(10) PRIMARY KEY,REPDATE DATE,LOCATION VARCHAR2(20));

 CREATE TABLE OWNS(DID VARCHAR2(20) REFERENCES PERSON PRIMARY KEY,CREGNO VARCHAR2(20) REFERENCES CAR );

 CREATE TABLE PARTICIPATED (DID VARCHAR2(20) REFERENCES PERSON PRIMARY KEY,CREGNO VARCHAR2(20) REFERENCES CAR,REPNO NUMBER (10) REFERENCES ACCIDENT,DAMAGEAMT NUMBER(10));




B) Enter at least five tuples for each relation.

INSERT INTO PERSON VALUES ('D1','FAYAZ','BHATKAL');
INSERT INTO PERSON VALUES ('D2','KAIF','BHATKAL');
INSERT INTO PERSON VALUES ('D3','EHAB','KUMTA');
INSERT INTO PERSON VALUES ('D4','AHTI','KERLA');
INSERT INTO PERSON VALUES ('D5','RABAY','OMAN');



INSERT INTO CAR VALUES ('KA-47-01','SWIFT',2001);
INSERT INTO CAR VALUES ('KA-47-02','DUSTER',2002);
INSERT INTO CAR VALUES ('KA-47-03','RITZ',2003);
INSERT INTO CAR VALUES ('KA-47-04','NANO',2004);
INSERT INTO CAR VALUES ('KA-47-05','VALVO',2005);


INSERT INTO ACCIDENT VALUES ('1','01-DEC-18','BANGLORE');
INSERT INTO ACCIDENT VALUES ('2','01-JAN-19','OOTI');
INSERT INTO ACCIDENT VALUES ('3','01-FEB-20','BENGAL');
INSERT INTO ACCIDENT VALUES ('4','01-MAR-21','CHENNAI');
INSERT INTO ACCIDENT VALUES ('5','01-APR-22','GUJRAT');




INSERT INTO OWNS VALUES ('D1','KA-47-01');
INSERT INTO OWNS VALUES ('D2','KA-47-02');
INSERT INTO OWNS VALUES ('D3','KA-47-03');
INSERT INTO OWNS VALUES ('D4','KA-47-04');
INSERT INTO OWNS VALUES ('D5','KA-47-05');


INSERT INTO PARTICIPATED VALUES ('D1','KA-47-01','1',1000);
INSERT INTO PARTICIPATED VALUES ('D2','KA-47-02','2',1100);
INSERT INTO PARTICIPATED VALUES ('D3','KA-47-03','3',1200);
INSERT INTO PARTICIPATED VALUES ('D4','KA-47-04','4',1300);
INSERT INTO PARTICIPATED VALUES ('D5','KA-47-05','5',1400);



C) View the Tables.

SELECT *FROM PERSON;

SELECT *FROM CAR;

SELECT *FROM ACCIDENT;

SELECT *FROM OWNS;

SELECT *FROM PARTICIPATED;


D) Demonstrate How You

i) Update Damage amount For The Car Of a Specific Regno In Accident Table With Report no 1 To 3

 UPDATE PARTICIPATED SET DAMAGEAMT=25000  WHEREE REGNO='KA-47-03'AND REPNO BETWEEN 1 AND 4;

 SELECT *FROM PARTICIPATED;


ii) add a new accident to the database

SQL> INSERT INTO ACCIDENT VALUES(6,'01-JUN-2022', 'BELAGAVI');

SOL> SELECT FROM ACCIDENT;


E) find the total number of people whose owned cars were involved in accidents in 2018.

SQL> SELECT COUNT(DID) FROM ACCIDENT, PARTICIPATED WHERE REPDATE BETWEEN 01-JAN-18 AND 31-DEC-18' AND ACCIDENT.REPNO-PARTICIPATED.REPNO;


F) find the number of accidents in which cars belonging to a specific model were involved.

SQL> SELECT FROM CAR;

SQL> SELECT COUNT(CMODEL) FROM ACCIDENT, PARTICIPATED, CAR WHERE ACCIDENT.REPNO=PARTICIPATED.REPNO AND CAR.CREGNO=PARTICIPATED.CREGNO AND CAR.MODEL ='NANO';